{"version":3,"sources":["webpack:////Users/lixu/Desktop/github/goldRecovery/comps/chat/msglist/msglist.vue?9b8c","webpack:////Users/lixu/Desktop/github/goldRecovery/comps/chat/msglist/msglist.vue?ebe4","webpack:////Users/lixu/Desktop/github/goldRecovery/comps/chat/msglist/msglist.vue?09d4","webpack:////Users/lixu/Desktop/github/goldRecovery/comps/chat/msglist/msglist.vue?0b00","webpack:////Users/lixu/Desktop/github/goldRecovery/comps/chat/msglist/msglist.vue","webpack:////Users/lixu/Desktop/github/goldRecovery/comps/chat/msglist/msglist.vue?b7f8","webpack:////Users/lixu/Desktop/github/goldRecovery/comps/chat/msglist/msglist.vue?34d9"],"names":["msgStorage","require","disp","LIST_STATUS","SHORT","NORMAL","page","Index","curMsgMid","isFail","components","audioMsg","props","username","type","Object","value","data","view","toView","chatMsg","visibility","beforeMount","beforeDestroy","created","onReady","create_or_onready","methods","me","myUsername","uni","getStorageSync","sessionKey","groupId","your","renderMsg","setStorageSync","on","err","mid","renderableMsg","curChatMsg","sesskey","info","from","to","normalScroll","shortScroll","onTap","$emit","previewImage","event","url","target","dataset","urls","getHistoryMsg","console","log","wx","historyChatMsgs","length","timesMsgList","slice","setData","concat","stopPullDownRefresh","isnew","map","elem","index","item","i","splice","item2","index2","pageScrollTo","scrollTop","renderFail","msgList","substring","msg","isShow"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsF;AAC3B;AACL;AACa;;;AAGnE;AAC6K;AAC7K,gBAAgB,4KAAU;AAC1B,EAAE,6EAAM;AACR,EAAE,kFAAM;AACR,EAAE,2FAAe;AACjB;AACA;AACA;AACA;;AAEA;;AAEA;AACA,IAAI,KAAU,EAAE,YAiBf;AACD;AACe,gF;;;;;;;;;;;;ACvCf;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACNA;AAAA;AAAA;AAAA;AAAy+B,CAAgB,g6BAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACuC7/B,IAAIA,UAAU,GAAGC,mBAAO,CAAC,uBAAD,CAAxB;AACA,IAAIC,IAAI,GAAGD,mBAAO,CAAC,kCAAD,CAAlB;AACA,IAAIE,WAAW,GAAG;AACjBC,OAAK,EAAE,oBADU;AAEjBC,QAAM,EAAE,aAFS,EAAlB;;AAIA,IAAIC,IAAI,GAAG,CAAX;AACA,IAAIC,KAAK,GAAG,CAAZ;AACA,IAAIC,SAAS,GAAG,EAAhB;AACA,IAAIC,MAAM,GAAG,KAAb,C;AACe;AACdC,YAAU,EAAE;AACXC,YAAQ,EAARA,QADW,EADE;;AAIdC,OAAK,EAAE;AACNC,YAAQ,EAAE;AACTC,UAAI,EAAEC,MADG;AAETC,WAAK,EAAE,EAFE,EADJ,EAJO;;;AAUdC,MAVc,kBAUP;AACN,WAAO;AACNC,UAAI,EAAEf,WAAW,CAACE,MADZ;AAENc,YAAM,EAAE,EAFF;AAGNC,aAAO,EAAE,EAHH;AAINC,gBAAU,EAAE,KAJN,EAAP;;AAMA,GAjBa;AAkBdC,aAlBc,yBAkBA;AACb,SAAKD,UAAL,GAAkB,IAAlB;AACAf,QAAI,GAAG,CAAP;AACAC,SAAK,GAAG,CAAR;AACA,GAtBa;AAuBdgB,eAvBc,2BAuBE;AACf,SAAKF,UAAL,GAAkB,KAAlB;AACA,GAzBa;AA0BdG,SA1Bc,qBA0BJ;AACT;;;;AAIA,GA/Ba;;AAiCdC,SAjCc,qBAiCJ;;AAET,SAAKC,iBAAL;;AAEA,GArCa;AAsCdC,SAAO,EAAE;AACRD,qBADQ,+BACY;AACnB,UAAIE,EAAE,GAAG,IAAT;;AAEA,UAAIf,QAAQ,GAAG,KAAKA,QAApB;AACA,UAAIgB,UAAU,GAAGC,GAAG,CAACC,cAAJ,CAAmB,YAAnB,CAAjB;AACA,UAAIC,UAAU,GAAGnB,QAAQ,CAACoB,OAAT;AAChBpB,cAAQ,CAACoB,OAAT,GAAmBJ,UADH;AAEhBhB,cAAQ,CAACqB,IAAT,GAAgBL,UAFjB;;AAIA,UAAIT,OAAO,GAAGU,GAAG,CAACC,cAAJ,CAAmBC,UAAnB,KAAkC,EAAhD;;AAEA,WAAKG,SAAL,CAAe,IAAf,EAAqB,IAArB,EAA2Bf,OAA3B,EAAoCY,UAApC;AACAF,SAAG,CAACM,cAAJ,CAAmBJ,UAAnB,EAA+B,IAA/B;;AAEA9B,UAAI,CAACmC,EAAL,CAAQ,0BAAR,EAAoC,UAASC,GAAT,EAAc;AACjD9B,iBAAS,GAAG8B,GAAG,CAACrB,IAAJ,CAASsB,GAArB;AACA9B,cAAM,GAAG,IAAT;AACA;AACA,OAJD;;AAMAT,gBAAU,CAACqC,EAAX,CAAc,YAAd,EAA4B,UAASG,aAAT,EAAwB1B,IAAxB,EAA8B2B,UAA9B,EAA0CC,OAA1C,EAAmD;AAC9Ed,UAAE,CAACa,UAAH,GAAgBA,UAAhB;AACA,YAAI,CAACb,EAAE,CAACP,UAAR,EAAoB;AACpB;AACA,YAAIR,QAAQ,CAACoB,OAAb,EAAsB;AACrB;AACA,cAAIO,aAAa,CAACG,IAAd,CAAmBC,IAAnB,IAA2B/B,QAAQ,CAACoB,OAApC,IAA+CO,aAAa,CAACG,IAAd,CAAmBE,EAAnB,IAAyBhC,QAAQ,CAACoB,OAArF,EAA8F;AAC7F,gBAAIS,OAAO,IAAIV,UAAf,EAA2B;AAC1BJ,gBAAE,CAACO,SAAH,CAAaK,aAAb,EAA4B1B,IAA5B,EAAkC2B,UAAlC,EAA8CT,UAA9C,EAA0D,QAA1D;AACA;;AAED;AACD,SARD,MAQO,IAAIQ,aAAa,CAACG,IAAd,CAAmBC,IAAnB,IAA2B/B,QAAQ,CAACqB,IAApC,IAA4CM,aAAa,CAACG,IAAd,CAAmBE,EAAnB,IAAyBhC,QAAQ,CAACqB,IAAlF,EAAwF;AAC9F,cAAIQ,OAAO,IAAIV,UAAf,EAA2B;AAC1BJ,cAAE,CAACO,SAAH,CAAaK,aAAb,EAA4B1B,IAA5B,EAAkC2B,UAAlC,EAA8CT,UAA9C,EAA0D,QAA1D;AACA;AACD;;AAED,OAlBD;AAmBA,KAxCO;AAyCRc,gBAzCQ,0BAyCO;AACd,WAAK5B,IAAL,GAAYf,WAAW,CAACE,MAAxB;AACA,KA3CO;;AA6CR0C,eA7CQ,yBA6CM;AACb,WAAK7B,IAAL,GAAYf,WAAW,CAACC,KAAxB;AACA,KA/CO;;AAiDR4C,SAjDQ,mBAiDA;AACP;AACA,WAAKC,KAAL,CAAW,YAAX;AACA;AACA,KArDO;;AAuDRC,gBAvDQ,wBAuDKC,KAvDL,EAuDY;AACnB,UAAIC,GAAG,GAAGD,KAAK,CAACE,MAAN,CAAaC,OAAb,CAAqBF,GAA/B;AACAtB,SAAG,CAACoB,YAAJ,CAAiB;AAChBK,YAAI,EAAE,CAACH,GAAD,CADU,CACJ;AADI,OAAjB;AAGA,KA5DO;;AA8DRI,iBA9DQ,2BA8DQ;AACfC,aAAO,CAACC,GAAR,CAAY,eAAZ;AACA;AACA,UAAI9B,EAAE,GAAG,IAAT;AACA,UAAIf,QAAQ,GAAG,KAAKI,IAAL,CAAUJ,QAAzB;AACA,UAAIgB,UAAU,GAAG8B,EAAE,CAAC5B,cAAH,CAAkB,YAAlB,CAAjB;AACA,UAAIC,UAAU,GAAGnB,QAAQ,CAACoB,OAAT,GAAmBpB,QAAQ,CAACoB,OAAT,GAAmBJ,UAAtC,GAAmDhB,QAAQ,CAACqB,IAAT,GAAgBL,UAApF;AACA,UAAI+B,eAAe,GAAGD,EAAE,CAAC5B,cAAH,CAAkB,cAAcC,UAAhC,KAA+C,EAArE;;AAEA,UAAIzB,KAAK,GAAGqD,eAAe,CAACC,MAA5B,EAAoC;AACnC,YAAIC,YAAY,GAAGF,eAAe,CAACG,KAAhB,CAAsB,CAACxD,KAAD,GAAS,EAA/B,EAAmC,CAACA,KAApC,CAAnB;;AAEA,aAAKyD,OAAL,CAAa;AACZ5C,iBAAO,EAAE0C,YAAY,CAACG,MAAb,CAAoBrC,EAAE,CAACX,IAAH,CAAQG,OAA5B,CADG;AAEZD,gBAAM,EAAE2C,YAAY,CAACA,YAAY,CAACD,MAAb,GAAsB,CAAvB,CAAZ,CAAsCtB,GAFlC,EAAb;;AAIAhC,aAAK,IAAIuD,YAAY,CAACD,MAAtB;AACA,YAAIC,YAAY,CAACD,MAAb,IAAuB,EAA3B,EAA+B;AAC9BvD,cAAI;AACJ;AACDqD,UAAE,CAACO,mBAAH;AACA;AACD,KApFO;AAqFR/B,aArFQ,qBAqFEK,aArFF,EAqFiB1B,IArFjB,EAqFuB2B,UArFvB,EAqFmCT,UArFnC,EAqF+CmC,KArF/C,EAqFsD;AAC7D,UAAIvC,EAAE,GAAG,IAAT;AACA,UAAIa,UAAU,CAACoB,MAAX,GAAoB,CAAxB,EAA2B;AAC1B,aAAKzC,OAAL,CAAagD,GAAb,CAAiB,UAASC,IAAT,EAAeC,KAAf,EAAsB;AACtC7B,oBAAU,CAAC2B,GAAX,CAAe,UAASG,IAAT,EAAeC,CAAf,EAAkB;AAChC,gBAAIH,IAAI,CAAC9B,GAAL,IAAYgC,IAAI,CAAChC,GAArB,EAA0B;AACzB;AACAE,wBAAU,CAACgC,MAAX,CAAkBD,CAAlB,EAAqB,CAArB;AACA;AACD,WALD;AAMA,SAPD;AAQA;;;AAGD,UAAIZ,eAAe,GAAG9B,GAAG,CAACC,cAAJ,CAAmB,cAAcC,UAAjC,KAAgD,EAAtE;;AAEA4B,qBAAe,GAAGA,eAAe,CAACK,MAAhB,CAAuBxB,UAAvB,CAAlB;;AAEA;AACAgB,aAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBE,eAApB;AACA,UAAI,CAACA,eAAe,CAACC,MAArB,EAA6B;;AAE7B,UAAIM,KAAK,IAAI,QAAb,EAAuB;AACtBV,eAAO,CAACC,GAAR,CAAY,IAAZ;AACA,aAAKtC,OAAL,GAAe,KAAKA,OAAL,CAAa6C,MAAb,CAAoBxB,UAApB,CAAf;AACA,aAAKtB,MAAL,GAAcyC,eAAe,CAACA,eAAe,CAACC,MAAhB,GAAyB,CAA1B,CAAf,CAA4CtB,GAA1D;AACA,OAJD,MAIO;AACNkB,eAAO,CAACC,GAAR,CAAY,IAAZ;AACA;AACA,aAAKtC,OAAL,GAAewC,eAAf;AACA,aAAKzC,MAAL,GAAcyC,eAAe,CAACA,eAAe,CAACC,MAAhB,GAAyB,CAA1B,CAAf,CAA4CtB,GAA1D;AACA;;AAEDT,SAAG,CAACM,cAAJ,CAAmB,cAAcJ,UAAjC,EAA6C4B,eAA7C;;AAEA,UAAIxC,OAAO,GAAGU,GAAG,CAACC,cAAJ,CAAmBC,UAAnB,KAAkC,EAAhD;AACAZ,aAAO,CAACgD,GAAR,CAAY,UAASG,IAAT,EAAeD,KAAf,EAAsB;AACjC7B,kBAAU,CAAC2B,GAAX,CAAe,UAASM,KAAT,EAAgBC,MAAhB,EAAwB;AACtC,cAAID,KAAK,CAACnC,GAAN,IAAagC,IAAI,CAAChC,GAAtB,EAA2B;AAC1BnB,mBAAO,CAACqD,MAAR,CAAeH,KAAf,EAAsB,CAAtB;AACA;AACD,SAJD;AAKA,OAND;;;AASAxC,SAAG,CAACM,cAAJ,CAAmBJ,UAAnB,EAA+BZ,OAA/B;AACAb,WAAK,GAAGqD,eAAe,CAACG,KAAhB,CAAsB,CAAC,EAAvB,EAA2BF,MAAnC;AACA/B,SAAG,CAAC8C,YAAJ,CAAiB;AAChBC,iBAAS,EAAE,IADK,EAAjB;;;AAIA,UAAIpE,MAAJ,EAAY;AACX,aAAKqE,UAAL,CAAgB9C,UAAhB;AACA;AACD,KA3IO;;AA6IR8C,cA7IQ,sBA6IG9C,UA7IH,EA6Ie;AACtB,UAAIJ,EAAE,GAAG,IAAT;AACA,UAAImD,OAAO,GAAGnD,EAAE,CAACR,OAAjB;AACA2D,aAAO,CAACX,GAAR,CAAY,UAACG,IAAD,EAAU;AACrB,YAAIA,IAAI,CAAChC,GAAL,CAASyC,SAAT,CAAmBT,IAAI,CAAChC,GAAL,CAASsB,MAAT,GAAkB,EAArC,KAA4CrD,SAAS,CAACwE,SAAV,CAAoBxE,SAAS,CAACqD,MAAV,GAAmB,EAAvC,CAAhD,EAA4F;AAC3FU,cAAI,CAACU,GAAL,CAAShE,IAAT,CAAc,CAAd,EAAiBR,MAAjB,GAA0B,IAA1B;AACA8D,cAAI,CAAC9D,MAAL,GAAc,IAAd;AACAmB,YAAE,CAACR,OAAH,GAAa2D,OAAb;AACA;AACD,OAND;AAOA,UAAInD,EAAE,CAACa,UAAH,CAAc,CAAd,EAAiBF,GAAjB,IAAwB/B,SAA5B,EAAuC;AACtCoB,UAAE,CAACa,UAAH,CAAc,CAAd,EAAiBwC,GAAjB,CAAqBhE,IAArB,CAA0B,CAA1B,EAA6BiE,MAA7B,GAAsC,KAAtC;AACAtD,UAAE,CAACa,UAAH,CAAc,CAAd,EAAiByC,MAAjB,GAA0B,KAA1B;AACA;AACDpD,SAAG,CAACM,cAAJ,CAAmB,cAAcJ,UAAjC,EAA6C+C,OAA7C;AACAtE,YAAM,GAAG,KAAT;AACA,KA7JO,EAtCK,E;;;;;;;;;;;;;ACjDf;AAAA;AAAA;AAAA;AAAmzC,CAAgB,qrCAAG,EAAC,C;;;;;;;;;;;ACAv0C,uC","file":"comps/chat/msglist/msglist.js","sourcesContent":["import { render, staticRenderFns } from \"./msglist.vue?vue&type=template&id=4f89b114&\"\nimport script from \"./msglist.vue?vue&type=script&lang=js&\"\nexport * from \"./msglist.vue?vue&type=script&lang=js&\"\nimport style0 from \"./msglist.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('4f89b114', component.options)\n    } else {\n      api.reload('4f89b114', component.options)\n    }\n    module.hot.accept(\"./msglist.vue?vue&type=template&id=4f89b114&\", function () {\n      api.rerender('4f89b114', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"Users/lixu/Desktop/github/goldRecovery/comps/chat/msglist/msglist.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-hbuilderx/packages/webpack-uni-nvue-loader/lib/templateLoader.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./msglist.vue?vue&type=template&id=4f89b114&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./msglist.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./msglist.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport audioMsg from \"@/comps/chat/msglist/type/audio/audio.vue\";\n\nlet msgStorage = require(\"../msgstorage\");\nlet disp = require(\"../../../utils/broadcast\");\nlet LIST_STATUS = {\n\tSHORT: \"scroll_view_change\",\n\tNORMAL: \"scroll_view\"\n};\nlet page = 0;\nlet Index = 0;\nlet curMsgMid = ''\nlet isFail = false\nexport default {\n\tcomponents: {\n\t\taudioMsg\n\t},\n\tprops: {\n\t\tusername: {\n\t\t\ttype: Object,\n\t\t\tvalue: {},\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tview: LIST_STATUS.NORMAL,\n\t\t\ttoView: \"\",\n\t\t\tchatMsg: [],\n\t\t\tvisibility: false,\n\t\t}\n\t},\n\tbeforeMount() {\n\t\tthis.visibility = true;\n\t\tpage = 0;\n\t\tIndex = 0;\n\t},\n\tbeforeDestroy() {\n\t\tthis.visibility = false;\n\t},\n\tcreated() {\n\t\t//app端虽然会触发created，但是读取local storage为空\n\n\n\n\t},\n\n\tonReady() {\n\n\t\tthis.create_or_onready();\n\n\t},\n\tmethods: {\n\t\tcreate_or_onready() {\n\t\t\tlet me = this;\n\n\t\t\tlet username = this.username;\n\t\t\tlet myUsername = uni.getStorageSync(\"myUsername\");\n\t\t\tlet sessionKey = username.groupId ?\n\t\t\t\tusername.groupId + myUsername :\n\t\t\t\tusername.your + myUsername;\n\n\t\t\tlet chatMsg = uni.getStorageSync(sessionKey) || [];\n\n\t\t\tthis.renderMsg(null, null, chatMsg, sessionKey);\n\t\t\tuni.setStorageSync(sessionKey, null);\n\n\t\t\tdisp.on('em.xmpp.error.sendMsgErr', function(err) {\n\t\t\t\tcurMsgMid = err.data.mid\n\t\t\t\tisFail = true\n\t\t\t\treturn\n\t\t\t});\n\n\t\t\tmsgStorage.on(\"newChatMsg\", function(renderableMsg, type, curChatMsg, sesskey) {\n\t\t\t\tme.curChatMsg = curChatMsg;\n\t\t\t\tif (!me.visibility) return;\n\t\t\t\t// 判断是否属于当前会话\n\t\t\t\tif (username.groupId) {\n\t\t\t\t\t// 群消息的 to 是 id，from 是 name\n\t\t\t\t\tif (renderableMsg.info.from == username.groupId || renderableMsg.info.to == username.groupId) {\n\t\t\t\t\t\tif (sesskey == sessionKey) {\n\t\t\t\t\t\t\tme.renderMsg(renderableMsg, type, curChatMsg, sessionKey, 'newMsg');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t} else if (renderableMsg.info.from == username.your || renderableMsg.info.to == username.your) {\n\t\t\t\t\tif (sesskey == sessionKey) {\n\t\t\t\t\t\tme.renderMsg(renderableMsg, type, curChatMsg, sessionKey, 'newMsg');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t},\n\t\tnormalScroll() {\n\t\t\tthis.view = LIST_STATUS.NORMAL\n\t\t},\n\n\t\tshortScroll() {\n\t\t\tthis.view = LIST_STATUS.SHORT\n\t\t},\n\n\t\tonTap() {\n\t\t\t// console.log('onTap');\n\t\t\tthis.$emit('msglistTap');\n\t\t\t// this.triggerEvent(\"msglistTap\", null, { bubbles: true });\n\t\t},\n\n\t\tpreviewImage(event) {\n\t\t\tvar url = event.target.dataset.url;\n\t\t\tuni.previewImage({\n\t\t\t\turls: [url] // 需要预览的图片 http 链接列表\n\t\t\t});\n\t\t},\n\n\t\tgetHistoryMsg() {\n\t\t\tconsole.log('getHistoryMsg');\n\t\t\treturn;\n\t\t\tlet me = this\n\t\t\tlet username = this.data.username;\n\t\t\tlet myUsername = wx.getStorageSync(\"myUsername\");\n\t\t\tlet sessionKey = username.groupId ? username.groupId + myUsername : username.your + myUsername;\n\t\t\tlet historyChatMsgs = wx.getStorageSync(\"rendered_\" + sessionKey) || [];\n\n\t\t\tif (Index < historyChatMsgs.length) {\n\t\t\t\tlet timesMsgList = historyChatMsgs.slice(-Index - 10, -Index)\n\n\t\t\t\tthis.setData({\n\t\t\t\t\tchatMsg: timesMsgList.concat(me.data.chatMsg),\n\t\t\t\t\ttoView: timesMsgList[timesMsgList.length - 1].mid,\n\t\t\t\t});\n\t\t\t\tIndex += timesMsgList.length;\n\t\t\t\tif (timesMsgList.length == 10) {\n\t\t\t\t\tpage++\n\t\t\t\t}\n\t\t\t\twx.stopPullDownRefresh()\n\t\t\t}\n\t\t},\n\t\trenderMsg(renderableMsg, type, curChatMsg, sessionKey, isnew) {\n\t\t\tlet me = this\n\t\t\tif (curChatMsg.length > 1) {\n\t\t\t\tthis.chatMsg.map(function(elem, index) {\n\t\t\t\t\tcurChatMsg.map(function(item, i) {\n\t\t\t\t\t\tif (elem.mid == item.mid) {\n\t\t\t\t\t\t\t//me.data.chatMsg.splice(index, 1)\n\t\t\t\t\t\t\tcurChatMsg.splice(i, 1)\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t}\n\n\n\t\t\tvar historyChatMsgs = uni.getStorageSync(\"rendered_\" + sessionKey) || [];\n\n\t\t\thistoryChatMsgs = historyChatMsgs.concat(curChatMsg);\n\n\t\t\t// console.log('当前历史',renderableMsg)\n\t\t\tconsole.log('历史消息', historyChatMsgs)\n\t\t\tif (!historyChatMsgs.length) return;\n\n\t\t\tif (isnew == 'newMsg') {\n\t\t\t\tconsole.log(1111)\n\t\t\t\tthis.chatMsg = this.chatMsg.concat(curChatMsg)\n\t\t\t\tthis.toView = historyChatMsgs[historyChatMsgs.length - 1].mid\n\t\t\t} else {\n\t\t\t\tconsole.log(1111)\n\t\t\t\t// this.chatMsg = historyChatMsgs.slice(-10)\n\t\t\t\tthis.chatMsg = historyChatMsgs\n\t\t\t\tthis.toView = historyChatMsgs[historyChatMsgs.length - 1].mid\n\t\t\t}\n\n\t\t\tuni.setStorageSync(\"rendered_\" + sessionKey, historyChatMsgs);\n\n\t\t\tlet chatMsg = uni.getStorageSync(sessionKey) || [];\n\t\t\tchatMsg.map(function(item, index) {\n\t\t\t\tcurChatMsg.map(function(item2, index2) {\n\t\t\t\t\tif (item2.mid == item.mid) {\n\t\t\t\t\t\tchatMsg.splice(index, 1)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t})\n\n\n\t\t\tuni.setStorageSync(sessionKey, chatMsg);\n\t\t\tIndex = historyChatMsgs.slice(-10).length;\n\t\t\tuni.pageScrollTo({\n\t\t\t\tscrollTop: 9999,\n\t\t\t})\n\n\t\t\tif (isFail) {\n\t\t\t\tthis.renderFail(sessionKey)\n\t\t\t}\n\t\t},\n\n\t\trenderFail(sessionKey) {\n\t\t\tlet me = this\n\t\t\tlet msgList = me.chatMsg\n\t\t\tmsgList.map((item) => {\n\t\t\t\tif (item.mid.substring(item.mid.length - 10) == curMsgMid.substring(curMsgMid.length - 10)) {\n\t\t\t\t\titem.msg.data[0].isFail = true\n\t\t\t\t\titem.isFail = true\n\t\t\t\t\tme.chatMsg = msgList\n\t\t\t\t}\n\t\t\t})\n\t\t\tif (me.curChatMsg[0].mid == curMsgMid) {\n\t\t\t\tme.curChatMsg[0].msg.data[0].isShow = false;\n\t\t\t\tme.curChatMsg[0].isShow = false\n\t\t\t}\n\t\t\tuni.setStorageSync(\"rendered_\" + sessionKey, msgList);\n\t\t\tisFail = false\n\t\t}\n\t}\n}\n","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./msglist.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./msglist.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin"],"sourceRoot":""}